# 基本配置
mixed-port: 7890
bind-address: 0.0.0.0
allow-lan: true
ipv6: true
mode: rule
log-level: warning
external-controller: 0.0.0.0:9090

dns:
  enable: true
  ipv6: true
  listen: 0.0.0.0:53

  # 主解析 DNS（优先）
  nameserver:
    - 114.114.114.114
    - 223.5.5.5
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query

  # 代理专用 DNS（走代理时用）
  proxy-server-nameserver:
    - https://223.6.6.6/dns-query
     
proxies:
  - {name: Alpha, type: vless, server: 104.16.239.116, port: 443, uuid: 351e3c90-7f9f-4f40-bccc-bee0bb0ca951, network: ws, tls: true, udp: true, sni: helloworld.fotoman.com, client-fingerprint: randomized, skip-cert-verify: false, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.fotoman.com}}}
  - {name: Delta, type: vless, server: 198.41.197.15, port: 443, uuid: e02a245e-5548-4bfc-888a-f4eb0bbb6b25, network: ws, tls: true, udp: true, sni: helloworld.techtrendparts.com, client-fingerprint: randomized, skip-cert-verify: false, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.techtrendparts.com}}}
  - {name: Gamma, type: vless, server: 162.159.32.246, port: 443, uuid: 5f2616c7-a69c-4a56-94b0-2aa4a25f878f, network: ws, tls: true, udp: true, sni: helloworld.todsm.com, client-fingerprint: randomized, skip-cert-verify: false, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.todsm.com}}}
  - {name: Lambda, type: vless, server: 104.18.177.229, port: 443, uuid: e02a245e-5548-4bfc-888a-f4eb0bbb6b25, network: ws, tls: true, udp: true, sni: helloworld.techtrendparts.com, client-fingerprint: randomized, skip-cert-verify: false, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.techtrendparts.com}}}
  - {name: JP, type: vless, server: tky.todsm.com, port: 26197, uuid: bced37a5-b0c7-4d9b-f4f5-19c01076fd87, network: ws, tls: true, skip-cert-verify: false, servername: tky.todsm.com, client-fingerprint: randomized, ws-opts: {path: "/?ed=2560", headers: {Host: bing.com}}}

proxy-groups:
  - name: CDN
    type: url-test
    proxies:
      - Alpha
      - Delta
      - Gamma
      - Lambda
    url: https://www.gstatic.com/generate_204
    interval: 300
    icon: https://img.icons8.com/?size=100&id=S4NxkowMF95E&format=png&color=000000

rule-providers:
  gfw:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt
    path: ./ruleset/gfw.yaml
    interval: 86400

  telegramcidr:
    type: http
    behavior: ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt
    path: ./ruleset/telegramcidr.yaml
    interval: 86400
  
  pName:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
    path: ./ruleset/proxy.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt
    path: ./ruleset/lancidr.yaml
    interval: 86400

rules:
  # AI 相关
  - DOMAIN-KEYWORD,openai,JP
  - DOMAIN-KEYWORD,chatgpt,JP
  - DOMAIN-KEYWORD,grok,JP
  - DOMAIN-KEYWORD,gemini,JP
  - DOMAIN-KEYWORD,github,CDN

  # X / Twitter
  - DOMAIN-SUFFIX,x.com,JP
  - DOMAIN-SUFFIX,twitter.com,JP
  - DOMAIN-SUFFIX,t.co,JP
  - DOMAIN-SUFFIX,twimg.com,JP
  
  # Google Voice
  - DOMAIN-SUFFIX,voice.google.com,JP
  - DOMAIN,voice.l.google.com,JP
  - DOMAIN,voice.googleapis.com,JP
  - DOMAIN,hangouts.google.com,JP
  - DOMAIN,meet.google.com,JP

  # 黑名单列表
  - RULE-SET,gfw,CDN
  - RULE-SET,pName,CDN
  - RULE-SET,telegramcidr,JP

  # 默认直连
  - RULE-SET,lancidr,DIRECT
  - MATCH,DIRECT
