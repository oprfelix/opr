# Clash 配置文件
# 说明: 本配置文件适用于 Clash 客户端，支持 VLESS 协议，提供国内外加速、AI 专线和规则分流功能。
# 日期: 2025-04-11

# --------------------------------------
# 基础配置
# --------------------------------------
mixed-port: 7890              # 设置 HTTP 和 SOCKS 代理的混合端口
allow-lan: false              # 禁止局域网访问，增强安全性
mode: rule                    # 使用规则模式，根据规则分流流量
log-level: debug               # 日志级别，info 适合日常使用，调试时可改为 debug
external-controller: 127.0.0.1:9090  # 外部控制接口，仅限本地访问，用于 Clash 管理工具
ipv6: true                    # 启用 IPv6 支持，适配双栈网络环境

# --------------------------------------
# Geo 数据源配置
# --------------------------------------
# 用于加载 GeoIP 和 GeoSite 数据，支持地理位置和域名分流
geodata-mode: true            # 启用 Geo 数据库模式，提升规则匹配效率
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geoip.dat"    # GeoIP 数据源，用于 IP 地理位置判断
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"  # GeoSite 数据源，用于域名分类

# --------------------------------------
# DNS 配置
# --------------------------------------
# 配置 DNS 解析策略，优化国内外域名解析并防止 DNS 污染
dns:
  enable: true                  # 启用 Clash 内置 DNS 解析模块
  listen: 0.0.0.0:1053          # DNS 服务监听地址和端口
  enhanced-mode: fake-ip        # 使用 Fake-IP 模式，提升性能并防止 DNS 泄露
  fake-ip-range: 198.18.0.1/16  # Fake-IP 地址范围，用于虚拟 IP 分配
  # 主 DNS 服务器（用于初始解析和国内域名）
  nameserver:
    - https://1.1.1.1/dns-query       # Cloudflare DNS - DoH
    - 1.1.1.1                         # Cloudflare DNS - 普通 UDP/TCP

# --------------------------------------
# 代理节点配置
# --------------------------------------
# 定义多个 VLESS 代理节点，按地区和服务类型分组
proxies:
  # 欧美加速节点（适用于高带宽需求，如视频流媒体）
  - {name: US1, server: 141.101.122.62, port: 443, type: vless, uuid: 2ce767ed-d5f5-4443-962c-eb555f75f0e3, tls: true, skip-cert-verify: false, servername: helloworld.fotoman.com, network: ws, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.fotoman.com}}}
  - {name: US2, server: 162.159.45.139, port: 443, type: vless, uuid: e02a245e-5548-4bfc-888a-f4eb0bbb6b25, tls: true, skip-cert-verify: false, servername: helloworld.techtrendparts.com, network: ws, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.techtrendparts.com}}}
  - {name: US3, server: 162.159.39.146, port: 443, type: vless, uuid: 5f2616c7-a69c-4a56-94b0-2aa4a25f878f, tls: true, skip-cert-verify: false, servername: helloworld.todsm.com, network: ws, ws-opts: {path: "/?ed=2560", headers: {Host: helloworld.todsm.com}}}
  
# --------------------------------------
# 代理组配置
# --------------------------------------
# 定义代理组，用于节点选择和负载均衡
proxy-groups:
  # 主代理组，手动选择地区或服务
  - name: PROXY
    type: load-balance              # 手动选择代理组或节点
    proxies:
      - US
      - US1
      - US2
      - US3
      - US4
      - US5
      - US6
      - US7
      - US8
      - US9
    icon: https://img.icons8.com/?size=100&id=S4NxkowMF95E&format=png&color=000000

rules:
  - DOMAIN-KEYWORD,quanmaitong,DIRECT
  - DOMAIN-KEYWORD,lingxing,DIRECT

  # Linkedin 服务（优先匹配）
  - DOMAIN-KEYWORD,linkedin,PROXY        # 匹配含 "linkedin" 的域名
  - DOMAIN-KEYWORD,licdn,PROXY

  # 广告拦截
  - GEOSITE,category-ads-all,REJECT  # 屏蔽广告相关域名

  # 国内服务直连
  - GEOSITE,apple@cn,DIRECT         # 苹果中国服务直连
  - GEOSITE,microsoft@cn,DIRECT     # 微软中国服务直连
  - GEOSITE,geolocation-cn,DIRECT   # 国内域名直连
  - GEOIP,private,DIRECT,no-resolve # 私有网络 IP 直连
  - GEOIP,cn,DIRECT                 # 中国大陆 IP 直连

  # 国外服务走代理
  - GEOSITE,facebook,PROXY          # Facebook 相关域名走代理
  - GEOSITE,youtube,PROXY           # YouTube 相关域名走代理
  - GEOSITE,google,PROXY            # Google 相关域名走代理
  - GEOIP,telegram,PROXY,no-resolve # Telegram IP 走代理
  - GEOSITE,geolocation-!cn,PROXY   # 非中国域名走代理

  # 默认规则
  - MATCH,PROXY                     # 未匹配的流量走 PROXY 组
